# Damga CLI Development

## Local development

To run a sample command: 

```shell
go run . tg add-target --api-key=ASD --id 67058cdd0d1b707123eac0e4 --target 1.2.3.4
```

Build the project:

```shell
go build -o ./damga .
```

Build the project and put it into global executable folder to access `damga` command globally:
```shell
go build -o /usr/local/bin/damga .
```

## Releasing a new version

### Preparing the release

Check the existing tags and releases on the repo to avoid conflicts and override.
```shell
git tag --list
```

Build the project with the new version tag. This command generates the archives 
needs to be attached to the release on GitHub into `/releases` folder.

```shell
# put the new version here
VERSION=1.0.1

# generate the archives to be attached to the release
make archive-release VERSION=$VERSION
```

Create a git tag with the desired version and push the tag.

```shell
# create new tag
git tag -a damga-cli-v$VERSION -m ""

# push new tag
git push origin damga-cli-v$VERSION
```

### Creating the release
- Go to releases page on GitHub repo and click **Draf a new release**.
- Choose the tag created above.
- Attach the archives in `/releases` folder generated by the `archive-release` command.
- Provide proper description.
- Click **Publish release**
